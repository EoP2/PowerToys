## Telemetry Prologue
 * Before starting your tests, go to General settings, enable "Diagnostic data" and "Enable viewing" and restart PowerToys.

## Telemetry Epilogue
 * After finishing your tests, go to General settings, press Diagnostic data viewer and check if you have xml files for the utilities you've tested and if it looks like the events in those xml files were generated by the actions you did with the utilities you've tested.

## [Install tests](tests-checklist-template-installer-section.md)
 * install a **previous version** on a clean machine (a clean machine doesn't have the `%localappdata%\Microsoft\PowerToys` folder)
 * open the Settings and for each module change at least one option
 * open the FancyZones editor and create two custom layouts:
    * a canvas layout with 2 zones, use unicode chars in the layout's name
    * one from grid template using 4 zones and splitting one zone
    * apply the custom canvas layout to the primary desktop
    * create a virtual desktop and apply the custom grid layout
    * if you have a second monitor apply different templates layouts for the primary desktop and for the second virtual desktop
 * install the new version (it will uninstall the old version and install the new version)
 - [] verify the settings are preserved and FancyZones configuration is still the same
 - [] test installing as SYSTEM (LocalSystem account)
   * Remove current PowerToys.
   * Download PsTools from https://learn.microsoft.com/en-us/sysinternals/downloads/psexec
   * Run PowerToys installer with psexec tool `psexec.exe -sid <path_to_installer_exe`
   * Brief check if all modules are working

 * PER-USER and PER-MACHINE TESTS:
   * Install **previous version** on a clean machine and update with new per-machine version. Ensure that it is installed in Program files and that registry entries are under **HKLM**/Software/Classes/PowerToys. Go trhough different modules and ensure that they are working correctly.
   * Try installing per-user version over already installed per-machine version and ensure that proper error message is shown.
   * Remove PowerToys and install per-user version. Ensure that it is installed in <APPDATA>/Local/PowerToys and that registry entries are under **HKCU**/Software/Classes/PowerToys. Go trhough different modules and ensure that they are working correctly.
   * Create a new user and install per-user version there as well. Go trhough different modules and ensure that they are working correctly. Ensure that changing settings for one user does not change settings of other user.

## Localization
 Change the Windows language to a language different than English. Then verify if the following screens change their language:
 - [] System tray menu items
 - [] Settings
 - [] OOBE (What's new)
 - [] PowerToys Run ("Start typing" string is localized, for example)
 - [] File Explorer menu entries for Image Resizer, Power Rename and FileLocksmith
 - [] Hosts File Editor

## [General Settings](tests-checklist-template-settings-section.md)

**Admin mode:**
 - [] restart PT and verify it runs as user
 - [] restart as admin and set "Always run as admin"
 - [] restart PT and verify it  runs as admin
 * if it's not on, turn on "Run at startup"
 - [] reboot the machine and verify PT runs as admin (it should not prompt the UAC dialog)
 * turn Always run as admin" off
 - [] reboot the machine and verify it now runs as user

**Modules on/off:**
 - [] turn off all the modules and verify all module are off
 - [] restart PT and verify that all module are still off in the settings page and they are actually inactive
 - [] turn on all the module, all module are now working
 - [] restart PT and verify that all module are still on in the settings page and they are actually working

**Quick access tray icon flyout:**
 - [] Use left click on the system tray icon and verify the flyout appears. (It'll take a bit the first time)
 - [] Try to launch a module from the launch screen in the flyout.
 - [] Try disabling a module in the all apps screen in the flyout, make it a module that's launchable from the launch screen. Verify that the module is disabled and that it also disappeared from the launch screen in the flyout.
 - [] Open the main settings screen on a module page. Verify that when you disable/enable the module on the flyout, that the Settings page is updated too.

**Settings backup/restore:**
 - [] In the General tab, create a backup of the settings.
 - [] Change some settings in some PowerToys.
 - [] Restore the settings in the General tab and verify the Settings you've applied were reset.

## File Explorer Add-ons
 * Running as user:
   * go to PowerToys repo root
   - [] verify the README.md Preview Pane shows the correct content
   * go to PowerToys repo and visit src\modules\ShortcutGuide\ShortcutGuide\svgs
   - [] verify Preview Pane works for the SVG files
   - [] verify the Icon Preview works for the SVG file (loop through different icon preview sizes)
   * go to PowerToys repo and visit src\modules\previewpane\UnitTests-PdfPreviewHandler\HelperFiles
   - [] verify the Icon Preview works for the PDF file (loop through different icon preview sizes)
   * go to PowerToys repo and visit src\modules\previewpane\UnitTests-GcodePreviewHandler\HelperFiles
   - [] verify Preview Pane works for the gcode file
   - [] verify the Icon Preview works for the gcode file (loop through different icon preview sizes)
   * go to PowerToys repo and visit src\modules\previewpane\UnitTests-StlThumbnailProvider\HelperFiles
   - [] verify the Icon Preview works for the stl file (loop through different icon preview sizes)
   * go to PowerToys repo and visit src\runner
   - [] verify Preview Pane works for source files (shows syntax highlighting)
 * Running as admin (or user since recently):
   * open the Settings and turn off the Preview Pane and Icon Previous toggles
   * go to PowerToys repo root
   - [] verify the README.md Preview Pane doesn't show any content
   * go to PowerToys repo and visit src\modules\ShortcutGuide\ShortcutGuide\svgs
   - [] verify Preview Pane doesn't show the preview for the SVG files
   * the Icon Preview for the existing SVG will still show since the icons are cached (you can also use `cleanmgr.exe` to clean all thumbnails cached in your system). You may need to restart the machine for this setting to apply as well.
   - [] copy and paste one of the SVG file and verify the new file show the generic SVG icon
   * go to PowerToys repo and visit src\modules\previewpane\UnitTests-PdfPreviewHandler\HelperFiles
   - [] verify Preview Pane doesn't show the preview for the PDF file
   * go to PowerToys repo and visit src\modules\previewpane\UnitTests-GcodePreviewHandler\HelperFiles
   - [] verify Preview Pane doesn't show the preview for the gcode file
   * go to PowerToys repo and visit src\modules\previewpane\UnitTests-StlThumbnailProvider\HelperFiles
   - [] verify Preview Pane doesn't show the preview for the stl file (a generated thumbnail would show when there's no preview)
   * go to PowerToys repo and visit src\runner
   - [] verify Preview Pane doesn't show the preview for source code files or that it's a default previewer instead of Monaco

## OOBE
 * Quit PowerToys
 * Delete %localappdata%\Microsoft\PowerToys
 - [] Start PowerToys and verify OOBE opens
 * Change version saved on `%localappdata%\Microsoft\PowerToys\last_version.txt`
 - [] Start PowerToys and verify OOBE opens in the "What's New" page
 * Visit each OOBE section and for each section:
   - [] open the Settings for that module
   - [] verify the Settings work as expected (toggle some controls on/off etc.)
   - [] close the Settings
   - [] if it's available, test the `Launch module name` button
 * Close OOBE
 - [] Open the Settings and from the General page open OOBE using the `Welcome to PowerToys` link

## GPO
 * Copy the "PowerToys.admx" file to your Policy Definition template folder. (Example: C:\Windows\PolicyDefinitions) and copy the "PowerToys.adml" file to the matching language folder in your Policy Definition folder. (Example: C:\Windows\PolicyDefinitions\en-US)
   - [] Open the "Local Group Policy Editor" on Windows and verify there is a "Microsoft PowerToys" folder in Administrative Templates for both Computer Configuration and User Configuration.
 * In GPO, disable a module that can run as a standalone (FancyZones sounds good for this). Restart PowerToys.
   - [] Verify the module is not enabled.
   - [] Open settings and verify the module is not enabled and you can't enable it.
   - [] Try to open FancyZones Editor directly from the install folder and verify it doesn't run and adds a message to the log saying it didn't run because of GPO.
   - [] Verify the module can't be launched from the quick launcher system tray flyout launcher screen (FancyZones editor in this case).
   - [] Verify the module can't be enabled/disabled from the quick launcher system tray flyout.
 * In GPO, enable a module that can run as a standalone (FancyZones sounds good for this). Restart PowerToys.
   - [] Verify the module is enabled.
   - [] Open settings and verify the module is enabled and you can't disable it.
   - [] Verify the module can't be enabled/disabled from the quick launcher system tray flyout.
 * In GPO, try to set different settings in the Computer and User Configurations for a PowerToy. Restart PowerToys.
   - [] Verify that the setting in Computer Configuration has priority over the setting in User Configuration.
 * In GPO, disable a module that has a context menu entry (File Locksmith sounds good for this). Restart PowerToys.
   - [] Verify the module is not enabled. (No context menu entry)
   - [] Open settings and verify the module is not enabled and you can't enable it.
   - [] Try to open File Locksmith directly from the install folder and verify it doesn't run and adds a message to the log saying it didn't run because of GPO.
 * In GPO, disable a module that is a Preview Handler (Markdown Preview is good for this). Restart PowerToys.
   - [] Verify the module is not enabled. (Markdown files won't appear in the preview pane)
   - [] Open settings and verify the module is not enabled and you can't enable it.
 * Remember to reset all you Settings to Not Configured after the tests, both in Conputer and User Configurations.

## DSC
 * You need to have some prerequisites installed:
   - PowerShell >= 7.2 .
   - PSDesiredStateConfiguration 2.0.7 or higher `Install-Module -Name PSDesiredStateConfiguration`.
   - WinGet [version v1.6.2631 or later](https://github.com/microsoft/winget-cli/releases). (You'll likely have this one already)
 * Open a PowerShell 7 instance and navigate to the sample scripts from PowerToys (`src/dsc/Microsoft.PowerToys.Configure/examples/`).
   - [] Run `winget configure .\disableAllModules.winget`. Open PowerToys Settings and verify all modules are disabled.
   - [] Run `winget configure .\enableAllModules.winget`. Open PowerToys Settings and verify all modules are enabled.
   - [] Run `winget configure .\configureLauncherPlugins.winget`. Open PowerToys Settings and verify all PowerToys Run plugins are enabled, and the Program plugin is not global and its Activation Keyword has changed to "P:".
   - [] Run `winget configure .\configuration.winget`. Open PowerToys Settings the Settings have been applied. File Locksmith is disabled. Shortcut Guide is disabled with an overlay opacity set to 50. FancyZones is enabled with the Editor hotkey set to "Shift+Ctrl+Alt+F".
   - [] If you run a winget configure command above and PowerToys is running, it will eventually close and automatically reopen after the configuration process is done.
   - [] If you run a winget configure command above and PowerToys is not running, it won't automatically reopen after the configuration process is done.

## [Command Palette](tests-checklist-template-command-palette-section.md)
 * Check if Command Palette successfully install/uninstall with PowerToys.
   - [] Install PowerToys. Then check if Command Palette exist in the System Settings/App/Installed Apps.
   - [] UnInstall PowerToys. Then check if Command Palette doesn't exist in the System Settings/App/Installed Apps.
 * Enable Command Palette in settings and ensure that the hotkey brings up Command Palette
   - [] when PowerToys is running unelevated on start-up
   - [] when PowerToys is running as admin on start-up
   - [] when PowerToys is restarted as admin, by clicking the restart as admin button in settings.
 * Check that each of the plugins is working:
   - [] Installed Apps - launch a Win32 application
   - [] Installed Apps - launch a Win32 application as admin
   - [] Installed Apps - launch a packaged application
   - [] Calculator - ensure a mathematical input returns a correct response and is copied on enter.
   - [] File Search - open a file on the disk.
   - [] File Search - find a file and copy file path.
   - [] File Search - find a file and open containing folder.
   - [] Run Commands - execute a command. (e.g. `ping google.com`).
   - [] Windows Walker - Switch to another opening window.
   - [] Windows Walker - Switch to another opening window when powertoys run as admin.
   - [] WinGet - Search and install application through WinGet. (eg. `vscode`)
   - [] Web Search - Search anything by this extension.
   - [] Windows Terminal Profiles - Open profile.
   - [] Windows Terminal Profiles - Open profile as Admin.
   - [] Windows Settings - Open settings from extension.
   - [] Registry - navigate through the registry tree and open registry editor. Enter the action keyword `:` to get the root keys.
   - [] Registry - navigate through the registry tree and copy key path.
   - [] Windows Service - start, stop, restart windows service.
   - [] Time And Date - type `now`, `year`, `week` and verify the result is correct. 
   - [] Windows System Command - test `lock`.
   - [] Windows System Command - test `empty recycle bin`.
   - [] Windows System Command - test `shutdown`.
   - [] Windows System Command - Click your network adapter item and paste the result at notepad.
   - [] Bookmark - Add bookmarks to command palette.
   - [] Bookmark - Open your bookmarks (in Command Palette).
 - [] Disable Command Palette and ensure that the hotkey doesn't bring up Command Palette.
 * Test Extensions Manager
   - [] Enable/disable extensions and verify changes are picked up by Command Palette
   - [] Change `Global hot key` and verify changes are picked up by Command Palette
   - [] Change `Alias` and verify changes picked up by Command Palette
   - [] Disable all extensions and verify the warning message is shown (Currently not support).
