## Telemetry Prologue
 * Before starting your tests, go to General settings, enable "Diagnostic data" and "Enable viewing" and restart PowerToys.

## Telemetry Epilogue
 * After finishing your tests, go to General settings, press Diagnostic data viewer and check if you have xml files for the utilities you've tested and if it looks like the events in those xml files were generated by the actions you did with the utilities you've tested.

## [Advanced Paste](tests-checklist-template-advanced-paste-section.md)
  NOTES:
    When using Advanced Paste, make sure that window focused while starting/using Advanced paste is text editor or has text input field focused (e.g. Word).
 * Paste As Plain Text
   - [x] Copy some rich text (e.g word of the text is different color, another work is bold, underlined, etd.).
   - [x] Paste the text using standard Windows Ctrl + V shortcut and ensure that rich text is pasted (with all colors, formatting, etc.)
   - [x] Paste the text using Paste As Plain Text activation shortcut and ensure that plain text without any formatting is pasted.
   - [x] Paste again the text using standard Windows Ctrl + V shortcut and ensure the text is now pasted plain without formatting as well.
   - [x] Copy some rich text again.
   - [x] Open Advanced Paste window using hotkey, click Paste as Plain Text button and confirm that plain text without any formatting is pasted.
   - [x] Copy some rich text again.
   - [x] Open Advanced Paste window using hotkey, press Ctrl + 1 and confirm that plain text without any formatting is pasted.
 * Paste As Markdown
   - [] Open Settings and set Paste as Markdown directly hotkey
   - [x] Copy some text (e.g. some HTML text - convertible to Markdown)
   - [x] Paste the text using set hotkey and confirm that pasted text is converted to markdown
   - [x] Copy some text (same as in the previous step or different. If nothing is coppied between steps, previously pasted Markdown text will be picked up from clipboard and converted again to nested Markdown).
   - [x] Open Advanced Paste window using hotkey, click Paste as markdown button and confirm that pasted text is converted to markdown
   - [x] Copy some text (same as in the previous step or different. If nothing is coppied between steps, previously pasted Markdown text will be picked up from clipboard and converted again to nested Markdown).
   - [x] Open Advanced Paste window using hotkey, press Ctrl + 2 and confirm that pasted text is converted to markdown
 * Paste As JSON
   - [] Open Settings and set Paste as JSON directly hotkey
   - [x] Copy some XML or CSV text (or any other text, it will be converted to simple JSON object)
   - [x] Paste the text using set hotkey and confirm that pasted text is converted to JSON
   - [x] Copy some text (same as in the previous step or different. If nothing is coppied between steps, previously pasted JSON text will be picked up from clipboard and converted again to nested JSON).
   - [x] Open Advanced Paste window using hotkey, click Paste as markdown button and confirm that pasted text is converted to markdown
   - [x] Copy some text (same as in the previous step or different. If nothing is coppied between steps, previously pasted JSON text will be picked up from clipboard and converted again to nested JSON).
   - [x] Open Advanced Paste window using hotkey, press Ctrl + 3 and confirm that pasted text is converted to markdown
 * Paste as custom format using AI
   - [] Open Settings, navigate to Enable Paste with AI and set OpenAI key.
   - [] Copy some text to clipboard. Any text.
   - [] Open Advanced Paste window using hotkey, and confirm that Custom intput text box is now enabled. Write "Insert smiley after every word" and press Enter. Observe that result preview shows coppied text with smileys between words. Press Enter to paste the result and observe that it is pasted.
   - [] Open Advanced Paste window using hotkey. Input some query (any, feel free to play around) and press Enter. When result is shown, click regenerate button, to see if new result is generated. Select one of the results and paste. Observe that correct result is pasted.
   - [] Create few custom actions. Set up hotkey for custom actions and confirm they work. Enable/disable custom actions and confirm that the change is reflected in Advanced Paste UI - custom action is not listed. Try different ctrl + <num> in-app shortcuts for custom actions. Try moving custom actions up/down and confirm that the change is reflected in Advanced Paste UI.
   - [] Open Settings and disable Custom format preview. Open Advanced Paste window with hotkey, enter some query and press enter. Observe that result is now pasted right away, without showing the preview first.
   - [] Open Settings and Disable Enable Paste with AI. Open Advanced Paste window with hotkey and observe that Custom Input text box is now disabled.
 * Clipboard History
   - [] Open Settings and Enable clipboard history (if not enabled already). Open Advanced Paste window with hotkey, click Clipboard history and try deleting some entry. Check OS clipboard history (Win+V), and confirm that the same entry no longer exist.
   - [] Open Advanced Paste window with hotkey, click Clipboard history, and click any entry (but first). Observe that entry is put on top of clipboard history. Check OS clipboard history (Win+V), and confirm that the same entry is on top of the clipboard.
   - [] Open Settings and Disable clipboard history. Open Advanced Paste window with hotkey and observe that Clipboard history button is disabled.
 * Disable Advanced Paste, try different Advanced Paste hotkeys and confirm that it's disabled and nothing happens.

## Color Picker
* Enable the Color Picker in settings and ensure that the hotkey brings up Color Picker
  - [ ] 1. when PowerToys is running unelevated on start-up
  - [ ] 2. when PowerToys is running as admin on start-up
  - [ ] 3. when PowerToys is restarted as admin, by clicking the restart as admin button in the settings
- [ ] 4. Change `Activate Color Picker shortcut` and check the new shortcut is working
- [ ] 5. Try all three `Activation behavior`s(`Color Picker with editor mode enabled`, `Editor`, `Color Picker only`)
- [ ] 6. Change `Color format for clipboard` and check if the correct format is copied from the Color picker
- [ ] 7. Try to copy color formats to the clipboard from the Editor
- [ ] 8. Check `Show color name` and verify if color name is shown in the Color picker
- [ ] 9. Enable one new format, disable one existing format, reorder enabled formats and check if settings are populated to the Editor
- [ ] 10. Select a color from the history in the Editor
- [ ] 11. Remove color from the history in the Editor
- [ ] 12. Open the Color Picker from the Editor
- [ ] 13. Open Adjust color from the Editor
- [ ] 14. Check Color Picker logs for errors

## Image Resizer
- [ ] 1. Disable the Image Resizer and check that `Resize images` is absent in the context menu
- [ ] 2. Enable the Image Resizer and check that `Resize images` is present in the context menu. (On Win11) Check if both old context menu and Win11 tier1 context menu items are present when module is enabled.
- [ ] 3. Remove one image size and add a custom image size. Open the Image Resize window from the context menu and verify that changes are populated
- [ ] 4. Resize one image
- [ ] 5. Resize multiple images
- [ ] 6. Open the image resizer to resize a `.gif` file and verify the "Gif files with animations may not be correctly resized." warning appears.

- [ ] 7. Resize images with `Fill` option
- [ ] 8. Resize images with `Fit` option
- [ ] 9. Resize images with `Stretch` option

- [ ] 10. Resize images using dimension: Centimeters
- [ ] 11. Resize images using dimension: Inches
- [ ] 12. Resize images using dimension: Percents
- [ ] 13. Resize images using dimension: Pixels

- [ ] 14. Change `Filename format` to `%1 - %2 - %3 - %4 - %5 - %6` and check if the new format is applied to resized images
- [ ] 15. Check `Use original date modified` and verify that modified date is not changed for resized images. Take into account that `Resize the original pictures(don't create copy)` should be selected
- [ ] 16. Check `Make pictures smaller but not larger` and verify that smaller pictures are not resized
- [ ] 17. Check `Resize the original pictures (don't create copies)` and verify that the original picture is resized and a copy is not created
- [ ] 18. Uncheck `Ignore the orientation of pictures` and verify that swapped width and height will actually resize a picture if the width is not equal to the height

## [Keyboard Manager](tests-checklist-template-keyboard-manager-section.md)

UI Validation:

  - [ ] 1. In Remap keys, add and remove rows to validate those buttons. While the blank rows are present, pressing the OK button should result in a warning dialog that some mappings are invalid.
  - [ ] 2. Using only the Type buttons, for both the remap windows, try adding keys/shortcuts in all the columns. The right-side column in both windows should accept both keys and shortcuts, while the left-side column will accept only keys or only shortcuts for Remap keys and Remap shortcuts respectively. Validate that the Hold Enter and Esc accessibility features work as expected.
  - [ ] 3. Using the drop downs try to add key to key, key to shortcut, shortcut to key and shortcut to shortcut remapping and ensure that you are able to select remapping both by using mouse and by keyboard navigation.
  - [ ] 4. Validate that remapping can be saved by pressing the OK button and re-opening the windows loads existing remapping.

Remapping Validation:

For all the remapping below, try pressing and releasing the remapped key/shortcut and pressing and holding it. Try different behaviors like releasing the modifier key before the action key and vice versa.
  - [ ] 5. Test key to key remapping
    - A->B
    - Ctrl->A
    - A->Ctrl
    - Win->B (make sure Start menu doesn't appear accidentally)
    - B->Win (make sure Start menu doesn't appear accidentally)
    - A->Disable
    - Win->Disable
  - [ ] 6. Test key to shortcut remapping
    - A->Ctrl+V
    - B->Win+A
  - [ ] 7. Test shortcut to shortcut remapping
    - Ctrl+A->Ctrl+V
    - Win+A->Ctrl+V
    - Ctrl+V->Win+A
    - Win+A->Win+F
  - [ ] 8. Test shortcut to key remapping
    - Ctrl+A->B
    - Ctrl+A->Win
    - Win+A->B
  * Test app-specific remaps
    - [ ] 9. Similar remaps to above with Edge (entered as `msedge`), VSCode (entered as `code`) and cmd (entered as `windowsterminal`). For cmd try admin and non-admin (requires PT to run as admin)
    - [ ] 10. Try some cases where focus is lost due to the shortcut. Example remapping to Alt+Tab or Alt+F4
  - [ ] 11. Test switching between remapping while holding down modifiers - Eg. Ctrl+D->Ctrl+A and Ctrl+E->Ctrl+V, hold Ctrl and press D followed by E. Should select all and paste over it in a text editor. Similar steps for Windows key shortcuts.

## New+
 * Enable New+ in Settings.
   - [ ] 1. Verify NewPlus menu is in Explorer context menu. (Windows 11 tier 1 context menu only. May need Explorer restart.)
 * Disable New+ in Settings.
   - [ ] 2. Verify NewPlus menu is not in Explorer context menu.
 * Choose a different path for template folder.
   - [ ] 3. Verify the folder is created and empty.
   - [ ] 4. Copy a file to the templates folder, verify it's added to the New+ context menu and that if you select it the file is created.
   - [ ] 5. Copy a folder with files inside to the templates folder, verify it's added to the New+ context menu and that if you select it the folder and files inside are created.
   - [ ] 6. Delete all files and folders from inside the templates folder. Verify that no templates are available in the context menu.
   - [ ] 7. Disable and re-Enable New+ while the templates folder is still empty. Verify the default templates were copied over and are available in the context menu.
 * Test some Settings:
   - [ ] 8. Test the "Hide template filename extension" option in Settings.
   - [ ] 9. Test the "Hide template filename starting digits, spaces and dots" option in Settings.

## PowerRename
- [ ] 1. Check if disable and enable of the module works. (On Win11) Check if both old context menu and Win11 tier1 context menu items are present when module is enabled.
- [ ] 2. Check that with the `Show icon on context menu` icon is shown and vice versa.
- [ ] 3. Check if `Appear only in extended context menu` works.
- [ ] 4. Enable/disable autocomplete.
- [ ] 5. Enable/disable `Show values from last use`.
* Select several files and folders and check PowerRename options:
    - [ ] 6. Make Uppercase/Lowercase/Titlecase (could be selected only one at the time)
    - [ ] 7. Exclude Folders/Files/Subfolder Items (could be selected several)
    - [ ] 8. Item Name/Extension Only (one at the time)
    - [ ] 9. Enumerate Items. Test advanced enumeration using different values for every field ${start=10,increment=2,padding=4}.
    - [x] 10. Case Sensitive
    - [x] 11. Match All Occurrences. If checked, all matches of text in the `Search` field will be replaced with the Replace text. Otherwise, only the first instance of the `Search` for text in the file name will be replaced (left to right).
    * Use regular expressions
        - [ ] 12. Search with an expression (e.g. `(.*).png`)
        - [ ] 13. Replace with an expression (e.g. `foo_$1.png`)
        - [ ] 14. Replace using file creation date and time (e.g. `$hh-$mm-$ss-$fff` `$DD_$MMMM_$YYYY`)
        - [ ] 15. Turn on `Use Boost library` and test with Perl Regular Expression Syntax (e.g. `(?<=t)est`)
    * File list filters.
        - [ ] 16. In the `preview` window uncheck some items to exclude them from renaming.
        - [ ] 17. Click on the `Renamed` column to filter results.
        - [ ] 18. Click on the `Original` column to cycle between checked and unchecked items.

## Screen Ruler
 * Enable Screen Ruler. Then:
   - [ ] 1. Press the activation shortcut and verify the toolbar appears.
   - [ ] 2. Press the activation shortcut again and verify the toolbar disappears.
   - [ ] 3. Disable Screen Ruler and verify that the activation shortcut no longer activates the utility.
   - [ ] 4. Enable Screen Ruler and press the activation shortcut and verify the toolbar appears.
   - [ ] 5. Select the close button in the toolbar and verify it closes the utility.
 * With Screen Ruler enabled and activated:
   - [ ] 6. Use the Bounds utility to measure a zone by dragging with left-click. Verify right click dismisses the utility and that the measurement was copied into the clipboard.
   - [ ] 7. Use the Spacing utility to measure something and verify that left-click copies the measurement to the clipboard. Verify that right-click dismisses the utility.
   - [ ] 8. Use the Horizontal Spacing utility to measure something and verify that left-click copies the measurement to the clipboard. Verify that right-click dismisses the utility.
   - [ ] 9. Use the Vertical Spacing utility to measure something and verify that left-click copies the measurement to the clipboard. Verify that right-click dismisses the utility.
   - [ ] 10. While using a Spacing utility, verify that using the mouse scroll wheel will adjust pixel color tolerance while measuring.
   - [ ] 11. Open mspaint and draw 1px-thick straight line, also click with a pencil to draw a single pixel. In any Spacing mode, verify that one of line's dimension is 1, and pixel's dimensions are 1x1.
 * In a multi-monitor setup with different DPIs on each monitor:
   - [ ] 12. Verify that the utilities work well on each monitor, with continuous mode on and off.
   - [ ] 13. Without any window opened and a solid color as your background, verify the horizontal spacing matches the monitor's pixel width.
   - [ ] 14. Move your mouse back and forth around the edge of two monitors really quickly in each mode - verify nothing is broken.
   
 * Test the different settings and verify they are applied:
   - [ ] 15. Activation shortcut
   - [ ] 16. Continuous mode
   - [ ] 17. Per color channel edge detection
   - [ ] 18. Pixel tolerance for edge detection
   - [ ] 19. Draw feet on cross
   - [ ] 20. Line color

## [Text Extractor](tests-checklist-template-text-extractor-section.md)
 * Enable Text Extractor. Then:
   - [ ] 1. Press the activation shortcut and verify the overlay appears.
   - [ ] 2. Press Escape and verify the overlay disappears.
   - [ ] 3. Press the activation shortcut and verify the overlay appears.
   - [ ] 4. Right-click and select Cancel. Verify the overlay disappears.
   - [ ] 5. Disable Text Extractor and verify that the activation shortcut no longer activates the utility.
 * With Text Extractor enabled and activated:
   - [ ] 6. Try to select text and verify it is copied to the clipboard.
   - [ ] 7. Try to select a different OCR language by right-clicking and verify the change is applied.
 * In a multi-monitor setup with different DPIs on each monitor:
   - [ ] 8. Verify text is correctly captured on all monitors.
 * Test the different settings and verify they are applied:
   - [ ] 9. Activation shortcut
   - [ ] 10. OCR Language

## Quick Accent
 * Enable Quick Accent and open notepad. Then:
   - [ ] 1. Press `a` and the left or right arrow and verify the accent menu appears and adds the accented letter you've selected. Use left and arrow keys to cycle through the options.
   - [ ] 2. Press `a` and the space key and verify the accent menu appears and adds the accented letter you've selected. Use <kbd>Space</kbd> to navigate forward, <kbd>Space</kbd> + <kbd>Shift</kbd> to navigate backward.
   - [ ] 3. Disable Quick Accent and verify you can no longer add accented characters through Quick Accent.
 * Test the different settings and verify they are applied:
   - [ ] 4. Activation key
   - [ ] 5. Language (for example, Currency has no accents for 'a' but has for 's')
   - [ ] 6. Toolbar position (test every option, some had issues before)
   - [ ] 7. Input delay
   - [ ] 8. Exclude some apps. Verify that Quick Accent is not activated for them.
   - [ ] 9. Sort characters by frequency.
   - [ ] 10. Always start on the first character when using left/right arrows as activation method.
